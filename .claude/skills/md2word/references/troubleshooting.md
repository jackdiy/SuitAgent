# 故障排除指南

## 常见问题及解决方案

### 1. 文件编码问题

**问题描述**:
- 转换后出现乱码
- 中文字符显示异常
- 特殊字符丢失

**解决方案**:
```bash
# 确保文件是UTF-8编码
file -i input.md

# 如果不是UTF-8，转换编码
iconv -f gbk -t utf-8 input.md > input_utf8.md
```

**自动处理**:
程序会自动检测文件编码，支持UTF-8和GBK编码。

### 2. Mermaid图表渲染失败

**问题描述**:
- 图表无法生成图片
- 显示为文本代码
- 渲染超时

**可能原因**:
- 未安装mermaid-cli
- Node.js环境配置问题
- 图表语法错误

**解决方案**:
```bash
# 安装mermaid-cli
npm install -g @mermaid-js/mermaid-cli

# 检查安装
mmdc --version

# 测试简单图表
echo "graph TD; A[开始] --> B[结束]" | mmdc -o test.png
```

**降级处理**:
如果本地渲染失败，程序会自动将图表转换为文本描述。

### 3. 表格格式异常

**问题描述**:
- 表格边框缺失
- 单元格对齐异常
- 表格内容溢出

**检查要点**:
- 确保表格语法正确
- 检查分隔行是否完整
- 确认列数一致

**正确格式**:
```markdown
| 标题1 | 标题2 | 标题3 |
|-------|-------|-------|
| 内容1 | 内容2 | 内容3 |
| 内容4 | 内容5 | 内容6 |
```

### 4. 字体显示问题

**问题描述**:
- 仿宋字体不显示
- 字体被替换为其他字体
- 中英文混排异常

**解决方案**:
1. 确保系统已安装仿宋_GB2312字体
2. 检查Word版本兼容性
3. 尝试使用模板文件

**字体安装**:
```bash
# Windows系统
# 下载仿宋_GB2312字体文件
# 右键安装或复制到C:\Windows\Fonts

# macOS系统
# 下载字体文件
# 双击安装或使用字体册安装
```

### 5. 页面布局问题

**问题描述**:
- 页边距不正确
- 页面大小异常
- 内容被截断

**检查设置**:
- 确认页面设置为A4
- 检查页边距设置
- 验证打印机设置

**手动调整**:
在Word中：
1. 布局 → 页面设置
2. 纸张大小选择A4
3. 页边距设置标准值

## 性能优化

### 大文件处理
**问题**: 大文件转换速度慢
**解决**:
- 分批处理大文档
- 优化图片大小
- 关闭不必要的功能

### 内存使用
**问题**: 转换过程中内存占用高
**解决**:
- 降低图片质量设置
- 减少同时处理的文件数
- 重启程序释放内存

## 错误信息解读

### 常见错误代码
```
Error: Cannot find module 'python-docx'
解决: pip install python-docx

Error: Permission denied
解决: 检查文件权限，以管理员身份运行

Error: File not found
解决: 确认文件路径正确，文件存在
```

### 调试模式
启用详细输出查看处理过程：
```bash
python md2word.py input.md output.docx --verbose
```

## 预防措施

### 最佳实践
1. **备份原文件**: 转换前备份Markdown文件
2. **测试小样**: 先用小文件测试转换效果
3. **逐步构建**: 复杂文档分步骤创建
4. **定期保存**: 重要文档多次保存版本

### 文件管理
- 使用有意义的文件名
- 建立清晰的目录结构
- 版本控制和备份
- 记录转换参数

### 质量控制
1. **预览检查**: 转换后仔细检查格式
2. **对比原文**: 确保内容完整性
3. **格式验证**: 检查字体、间距、对齐
4. **打印测试**: 实际打印效果验证

## 获取帮助

### 自助资源
- 查看转换日志输出
- 参考格式化指南
- 检查模板设置
- 验证Markdown语法

### 技术支持
如问题持续存在：
1. 记录详细的错误信息
2. 准备示例文件
3. 描述具体操作步骤
4. 提供系统环境信息

### 更新维护
- 定期检查程序更新
- 关注依赖包版本
- 参与社区讨论
- 反馈使用体验