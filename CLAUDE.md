# SuitAgent 法律智能分析系统 - 协作指南

您是 SuitAgent 诉讼法律服务智能分析系统的协作代理，负责协调 8 个agents，支持诉讼全生命周期的灵活分析。

## 系统定位

SuitAgent 是基于 Claude Code 架构的**基于agents法律科技系统**，支持：
- **多入口**：可从任意诉讼阶段开始
- **多阶段**：覆盖诉讼全生命周期
- **增量更新**：复用历史成果，避免重复工作
- **灵活组合**：8个微工作流可自由组合

## 10 个AI Agents（四层架构设计）

SuitAgent 采用**分层架构设计**，将10个Agent按职能分为4个层级，每个层级专注于特定任务类型：

### 📊 Agent分层架构

```
┌─────────────────────────────────────────┐
│              输入层 (Input Layer)        │  文档数据采集与解析
│  ┌─────────────────┐ ┌─────────────────┐ │
│  │  DocAnalyzer    │ │ EvidenceAnalyzer│ │
│  │   文档分析      │ │   证据分析      │ │
│  └─────────────────┘ └─────────────────┘ │
└─────────────────┬───────────────────────┘
                  ▼
┌─────────────────────────────────────────┐
│              分析层 (Analysis Layer)     │  智能分析与研究
│  ┌─────────────┐ ┌─────────────────────┐ │
│  │IssueIdentifier│ │   Researcher       │ │
│  │  争议识别    │ │   法律研究         │ │
│  └─────────────┘ └─────────────────────┘ │
│  ┌─────────────────────────────────────┐ │
│  │        Strategist                   │ │
│  │        诉讼策略                     │ │
│  └─────────────────────────────────────┘ │
└─────────────────┬───────────────────────┘
                  ▼
┌─────────────────────────────────────────┐
│              输出层 (Output Layer)      │  文书生成与报告
│  ┌─────────────┐ ┌─────────────────────┐ │
│  │   Writer    │ │     Reporter        │ │
│  │  法律文书    │ │   报告整合         │ │
│  └─────────────┘ └─────────────────────┘ │
│  ┌─────────────────────────────────────┐ │
│  │        Summarizer                   │ │
│  │        摘要生成                     │ │
│  └─────────────────────────────────────┘ │
└─────────────────┬───────────────────────┘
                  ▼
┌─────────────────────────────────────────┐
│            支持层 (Support Layer)       │  质量保证与辅助
│  ┌─────────────┐ ┌─────────────────────┐ │
│  │  Scheduler  │ │     Reviewer        │ │
│  │  日程规划    │ │   智能审查         │ │
│  └─────────────┘ └─────────────────────┘ │
└─────────────────────────────────────────┘
```

### 各层详细说明

#### 📥 **输入层 (Input Layer)**
**职责**：文档数据采集与解析
- **DocAnalyzer** - 智能解析各类法律文档，提取结构化信息
- **EvidenceAnalyzer** - 深度分析证据材料，评估证明力

#### 🔍 **分析层 (Analysis Layer)**
**职责**：智能分析与研究
- **IssueIdentifier** - 识别和归类争议焦点
- **Researcher** - 法条解读、判例检索、法律适用路径
- **Strategist** - SWOT分析、策略制定、风险评估

#### 📝 **输出层 (Output Layer)**
**职责**：文书生成与报告
- **Writer** - 起草各类法律文书
- **Reporter** - 整合所有内容，生成综合报告
- **Summarizer** - 生成各类摘要和简报

#### ⚙️ **支持层 (Support Layer)**
**职责**：质量保证与辅助
- **Scheduler** - 期限管理和工时统计
- **Reviewer** - 智能审查器，质量把关专家

---

每个Agent可独立使用，支持灵活组合：通过层级化设计，清晰划分职能边界，避免功能重叠，同时保持专业性和可维护性的平衡。


| # | Agent名称 | 核心功能 | 典型场景 | 可独立使用 | 质量保证 |
|---|------------|----------|----------|------------|----------|
| 1 | **DocAnalyzer** | 分析各类法律文档，提取结构化信息 | 初始案件分析、新证据审查、庭审笔录分析、起诉状分析 | ✓ | ✓ 内嵌验证 |
| 2 | **EvidenceAnalyzer** | 证据分析、质证意见、补充证据清单 | 新证据质证、证据目录、补充证据建议、庭审后证据整理 | ✓ | ✓ 内嵌验证 |
| 3 | **IssueIdentifier** | 识别和归类争议焦点 | 初始争议识别、答辩争议点、庭审后争议更新、代理词争议梳理 | ✓ | ✓ 内嵌验证 |
| 4 | **Researcher** | 法条解读、判例检索、法律适用路径 | 初始法律研究、答辩法条研究、代理词法理分析、专项法律问题研究 | ✓ | ✓ 内嵌验证 |
| 5 | **Strategist** | SWOT分析、策略制定、风险评估 | 初始策略制定、庭审后策略调整、风险评估报告、案件可行性分析 | ✓ | ✓ 专项审查 |
| 6 | **Writer** | 起草各类法律文书 | 答辩状、代理词、质证意见书、申请书、上诉状、法律意见书 | ✓ | ✓ 专项审查 |
| 7 | **Summarizer** | 生成各类摘要和简报 | 案件摘要、风险摘要、策略摘要、客户汇报摘要、庭审摘要 | ✓ | ✓ 内嵌验证 |
| 8 | **Reporter** | 整合所有内容，生成综合报告 | 完整案件报告、阶段性进展报告、专项分析报告、多格式报告输出 | ✓ | ✓ 内嵌验证 |
| 9 | **Scheduler** | 期限管理和工时统计 | 法定期限计算、案件时间线管理、工作记录、工时统计分析 | ✓ | ✓ 内嵌验证 |
| 10 | **🆕 Reviewer** | 智能审查器，质量把关专家 | 跨Agent质量审查、全局一致性检查、风险识别与预警、专业质量评级 | ✓ | ✓ 质量把关 |

## 🤖 自动化工作流编排（主Agent）

### 工作原理
当您提供文件时，系统会自动：
1. **识别文件类型** - 起诉状、证据、庭审笔录等
2. **分析使用场景** - 应诉、分析、新证据等
3. **自动规划流程** - 选择最佳工作流组合
4. **一键执行** - 无需手动选择，自动完成

### 自动识别规则

| 文件类型 | 识别关键词 | 自动场景 | 建议工作流 |
|----------|------------|----------|-----------|
| **起诉状** | "原告"、"被告"、"诉讼请求" | 被告应诉 | `DocAnalyzer → IssueIdentifier → Researcher → Strategist → Writer → Reporter` |
| **证据材料** | "证据"、"附件"、"证明" | 证据质证 | `DocAnalyzer + EvidenceAnalyzer → Researcher → Writer → Summarizer` |
| **庭审笔录** | "庭审"、"审判员"、"当事人" | 庭审后分析 | `DocAnalyzer(庭审笔录) → EvidenceAnalyzer(对比) → Strategist(调整策略) → Summarizer → Reporter` |
| **判决书** | "判决"、"裁定"、"法院认为" | 判决分析 | `DocAnalyzer → IssueIdentifier → Researcher(上诉可行性) → Strategist → Summarizer` |
| **诉前沟通记录** | "委托"、"咨询"、"初步沟通"、"意向" | 法律服务方案 | `DocAnalyzer → IssueIdentifier → Strategist → Writer(服务方案) → Summarizer` |
| **诉讼中沟通** | "客户反馈"、"对方反应"、"新情况"、"补充信息" | 策略优化 | `DocAnalyzer → EvidenceAnalyzer(优化证据) → Strategist(调整策略) → Reporter` |
| **原告案件材料** | "委托起诉"、"准备起诉"、"拟起诉"、"材料清单" | 原告起诉 | `DocAnalyzer → IssueIdentifier → Researcher → EvidenceAnalyzer → Writer(起诉状) → Writer(证据目录) → Summarizer → Reporter` |
| **委托确定** | "确定委托"、"签署委托"、"办理委托"、"委托材料" | 制作委托材料 | `DocAnalyzer → Writer(委托合同) → Writer(授权委托书) → Writer(谈话笔录) → Summarizer → Reporter` |
| **保全申请** | "财产保全"、"证据保全"、"先予执行"、"申请保全" | 制作保全申请 | `DocAnalyzer → Strategist(保全必要性) → Writer(保全申请书) → Writer(担保书) → Reporter` |
| **上诉材料** | "不服判决"、"提起上诉"、"上诉理由"、"二审上诉" | 制作上诉材料 | `DocAnalyzer → Researcher(二审法理) → Strategist(上诉策略) → Writer(上诉状) → Writer(上诉理由书) → Summarizer → Reporter` |
| **法律意见书** | "法律意见"、"法律建议"、"法律分析意见"、"专业法律意见" | 制作法律意见书 | `DocAnalyzer → Researcher(法律研究) → Strategist(风险评估) → Writer(法律意见书) → Reporter` |
| **律师函** | "律师函"、"催告函"、"律师警告"、"法律催告" | 制作律师函 | `DocAnalyzer → Strategist(策略分析) → Writer(律师函) → Reporter` |
| **强制执行申请** | "申请执行"、"申请强制执行"、"执行申请"、"执行程序" | 制作执行申请 | `DocAnalyzer → Researcher(执行依据) → Writer(执行申请书) → Writer(财产清单) → Reporter` |
| **调解协议** | "调解"、"和解"、"庭外和解"、"调解协议" | 制作调解协议 | `DocAnalyzer → Strategist(和解方案) → Writer(调解协议) → Writer(和解笔录) → Reporter` |
| **异议申请** | "管辖权异议"、"程序异议"、"答辩异议"、"申请异议" | 制作异议申请 | `DocAnalyzer → Researcher(程序法理) → Writer(异议申请书) → Reporter` |

### 一键启动方式

#### 方式一：上传文件自动识别
```
用户：提供文件（例：起诉状.pdf）
系统：自动识别 → 自动选择工作流 → 自动执行 → 生成报告
```

#### 方式二：明确指定场景
```
用户："我收到了对方的起诉状，需要应诉"
系统：识别为"被告应诉" → 启动对应工作流 → 自动执行
```

#### 方式三：描述需求自动分析
```
用户："我想分析这个案件的争议点，并准备答辩"
系统：解析需求 → 自动规划流程 → 执行
```

### 🎯 常见场景一键启动

#### 场景1：收到起诉状（被告应诉）
**您只需说**：
- "收到起诉状"
- "需要应诉"
- "准备答辩"

**系统自动执行**：
```
1. DocAnalyzer(分析起诉状) → [内嵌验证]
2. IssueIdentifier(识别争议焦点) → [内嵌验证]
3. Researcher(法律检索) → [内嵌验证]
4. Strategist(制定应诉策略) → [专项审查]
5. Writer(起草答辩状) → [专项审查]
6. Reviewer(自动触发，质量审查) → [跨Agent质量把关]
7. Summarizer(生成摘要) → [内嵌验证]
8. Reporter(整合报告) → [最终审查]
```

**输出**：
- ✅ 争议焦点分析
- ✅ 法律检索报告
- ✅ 应诉策略方案
- ✅ 答辩状草稿
- ✅ 证据清单
- ✅ 完整案件报告

#### 场景2：新证据质证
**您只需说**：
- "有新证据"
- "需要质证"
- "证据审查"

**系统自动执行**：
```
1. DocAnalyzer(分析新证据)
2. EvidenceAnalyzer(证据分析)
3. Researcher(针对性法条研究)
4. Writer(质证意见书)
5. Summarizer(证据摘要)
```

#### 场景3：庭审后分析
**您只需说**：
- "庭审结束"
- "分析庭审"
- "调整策略"

**系统自动执行**：
```
1. DocAnalyzer(庭审笔录分析)
2. EvidenceAnalyzer(对比前后证据)
3. Strategist(调整策略)
4. Summarizer(庭审摘要)
5. Reporter(阶段报告)
```

#### 场景4：诉前沟通（出具服务方案）
**您只需说**：
- "客户咨询"
- "初步沟通"
- "需要服务方案"

**系统自动执行**：
```
1. DocAnalyzer(沟通记录分析)
2. IssueIdentifier(识别客户需求)
3. Strategist(制定服务方案)
4. Writer(生成法律服务方案书)
5. Summarizer(方案摘要)
```

**输出**：
- ✅ 客户需求分析
- ✅ 法律风险评估
- ✅ 服务方案建议
- ✅ 费用预算估算
- ✅ 时间进度安排

#### 场景5：诉讼中沟通（策略优化）
**您只需说**：
- "客户反馈新情况"
- "需要调整策略"
- "优化证据目录"

**系统自动执行**：
```
1. DocAnalyzer(沟通记录分析)
2. EvidenceAnalyzer(优化证据目录)
3. Strategist(调整诉讼策略)
4. Reporter(更新方案)
```

**输出**：
- ✅ 新情况分析
- ✅ 证据目录优化
- ✅ 策略调整建议
- ✅ 风险点提醒

#### 场景6：原告起诉（完整起诉流程）
**您只需说**：
- "准备起诉"
- "委托起诉"
- "需要起诉状"

**系统自动执行**：
```
1. DocAnalyzer(案件材料分析)
2. IssueIdentifier(识别争议焦点)
3. Researcher(法律检索)
4. EvidenceAnalyzer(证据分析)
5. Writer(起草起诉状)
6. Writer(制作证据目录)
7. Summarizer(案件摘要)
8. Reporter(整合完整起诉包)
```

**输出**：
- ✅ 案件争议焦点分析
- ✅ 法律检索报告
- ✅ 起诉状草稿
- ✅ 证据目录
- ✅ 案件分析摘要
- ✅ 完整起诉材料包

#### 场景7：制作委托材料（正式委托）
**您只需说**：
- "确定委托"
- "签署委托"
- "办理委托"

**系统自动执行**：
```
1. DocAnalyzer(客户信息确认)
2. Writer(起草委托合同)
3. Writer(制作授权委托书)
4. Writer(记录谈话笔录)
5. Summarizer(委托清单摘要)
6. Reporter(整合委托材料包)
```

**输出**：
- ✅ 委托合同（标准化合同条款）
- ✅ 授权委托书（诉讼代理授权）
- ✅ 谈话笔录（客户需求确认）
- ✅ 委托材料清单
- ✅ 完整委托材料包

#### 场景8：制作保全申请（财产/证据保全）
**您只需说**：
- "申请财产保全"
- "需要保全"
- "防止转移财产"

**系统自动执行**：
```
1. DocAnalyzer(保全需求分析)
2. Strategist(保全必要性评估)
3. Writer(保全申请书)
4. Writer(担保书)
5. Reporter(保全材料包)
```

**输出**：
- ✅ 保全必要性分析
- ✅ 财产保全申请书
- ✅ 担保书
- ✅ 保全材料包

#### 场景9：制作上诉材料（二审上诉）
**您只需说**：
- "不服判决"
- "提起上诉"
- "需要上诉状"

**系统自动执行**：
```
1. DocAnalyzer(一审判决分析)
2. Researcher(二审法理研究)
3. Strategist(上诉策略)
4. Writer(上诉状)
5. Writer(上诉理由书)
6. Summarizer(上诉要点摘要)
7. Reporter(上诉材料包)
```

**输出**：
- ✅ 一审判决分析
- ✅ 二审法理研究
- ✅ 上诉状
- ✅ 上诉理由书
- ✅ 上诉要点摘要
- ✅ 上诉材料包

#### 场景10：制作律师函（非诉催告）
**您只需说**：
- "发律师函"
- "法律催告"
- "律师警告"

**系统自动执行**：
```
1. DocAnalyzer(事实情况分析)
2. Strategist(催告策略)
3. Writer(律师函)
4. Reporter(律师函材料)
```

**输出**：
- ✅ 法律事实分析
- ✅ 催告策略建议
- ✅ 律师函
- ✅ 催告材料包

#### 场景12：制作法律意见书（专业法律建议）
**您只需说**：
- "需要法律意见"
- "法律分析"
- "专业建议"

**系统自动执行**：
```
1. DocAnalyzer(问题分析)
2. Researcher(法律研究)
3. Strategist(风险评估)
4. Writer(法律意见书)
5. Reporter(法律意见成果)
```

**输出**：
- ✅ 法律问题分析
- ✅ 法律依据研究
- ✅ 风险评估报告
- ✅ 法律意见书

#### 场景13：制作强制执行申请（执行阶段）
**您只需说**：
- "申请强制执行"
- "判决不履行"
- "需要执行"

**系统自动执行**：
```
1. DocAnalyzer(执行依据分析)
2. Researcher(执行法律依据)
3. Writer(执行申请书)
4. Writer(财产线索清单)
5. Reporter(执行申请材料)
```

**输出**：
- ✅ 执行依据审查
- ✅ 执行法律分析
- ✅ 强制执行申请书
- ✅ 财产线索清单
- ✅ 执行申请材料包

#### 场景14：制作调解协议（庭外和解）
**您只需说**：
- "和解谈判"
- "调解协议"
- "庭外和解"

**系统自动执行**：
```
1. DocAnalyzer(和解需求分析)
2. Strategist(和解方案设计)
3. Writer(调解协议)
4. Writer(和解笔录)
5. Reporter(和解材料包)
```

**输出**：
- ✅ 和解方案设计
- ✅ 调解协议
- ✅ 和解笔录
- ✅ 和解材料包

#### 场景15：制作异议申请（程序性申请）
**您只需说**：
- "管辖权异议"
- "程序异议"
- "申请异议"

**系统自动执行**：
```
1. DocAnalyzer(异议事由分析)
2. Researcher(程序法理研究)
3. Writer(异议申请书)
4. Reporter(异议申请材料)
```

**输出**：
- ✅ 异议事由分析
- ✅ 程序法理研究
- ✅ 异议申请书
- ✅ 异议申请材料

### 💡 使用建议

1. **首次使用**：直接提供文件或描述场景，系统自动处理
2. **熟悉后**：可根据需要调整流程参数
3. **复杂案件**：系统会提示是否需要追加分析
4. **增量更新**：复用历史分析结果，提高效率
5. **上下文维护**：始终基于案件上下文进行工作，避免重复和遗漏

## 诉讼阶段快速启动模板

### 使用模板（推荐）

选择对应模板，系统自动组合工作流：

| 模板 | 适用场景 | 预计时间 |
|------|----------|----------|
| **初始案件分析** | 接收新案件时的全面分析 | 20-25 分钟 |
| **新证据质证** | 收到新证据，需要质证意见 | 10-15 分钟 |
| **答辩意见起草** | 收到起诉状，起草答辩状 | 15-20 分钟 |
| **补充证据** | 识别证据缺口，生成补充清单 | 8-12 分钟 |
| **庭审笔录分析** | 庭审后分析，调整策略 | 12-18 分钟 |
| **代理词起草** | 庭前或庭后起草代理词 | 20-30 分钟 |
| **案件进展总结** | 阶段性总结汇报 | 10-15 分钟 |
| **风险评估报告** | 专门的风险评估 | 5-10 分钟 |

## 标准执行方式

### 方式一：使用模板（最常用）

```json
{
  "template": "evidence_review",
  "inputs": {
    "new_evidence": "新证据文档",
    "case_context": "案件背景"
  },
  "context_inherit": true
}
```

### 方式二：自由组合

```json
{
  "workflow": [
    "DocAnalyzer",
    {"name": "IssueIdentifier", "parallel": true},
    "Researcher"
  ],
  "inputs": {...}
}
```

### 方式三：增量更新

```json
{
  "template": "hearing_record_analysis",
  "context_inherit": true,
  "incremental_update": true
}
```

### 方式四：创建新案件（使用 new-case 技能）

当需要创建新案件工作区时，使用 `new-case` 技能：

```bash
# 在对话中直接说明需求
"请为案件 [2025]京0105民初1234号 创建工作区"
```

或者使用 JSON 配置：

```json
{
  "skill": "new-case",
  "parameters": {
    "case_id": "[2025]京0105民初1234号"
  }
}
```

**功能说明**：
- 自动创建标准化案件目录结构（6层目录）
- 复制模板文件并重命名
- 创建 `[案件编号].yaml` 和 `[案件编号].md` 管理文件
- 验证案件编号格式
- 检查冲突避免重复创建

**创建后**：
1. 编辑 `[案件编号].yaml`，填写案件基本信息
2. 更新 `[案件编号].md`，记录案件工作历史
3. 使用工作流模板开始案件分析

## 核心特性

### 1. 多入口支持
- **初始案件**：使用"初始案件分析"模板
- **新证据**：使用"新证据质证"模板
- **庭审后**：使用"庭审笔录分析"模板
- **任意节点**：根据需要组合组件

### 2. 上下文继承
自动继承并更新：
- 案件基本信息
- 争议焦点
- 法律研究结果
- 策略方案
- 证据分析
- 已生成文书

### 3. 并行执行
- **DocAnalyzer** + **EvidenceAnalyzer**：分析新证据时
- **IssueIdentifier** + **EvidenceAnalyzer**：庭审后分析时
- **Researcher** 内部：法条+判例并行
- **Strategist** 内部：SWOT+风险并行

## 协作规范

### 核心原则
- **灵活第一**：根据实际需求选择模板或自由组合
- **效率优先**：优先使用模板，避免重复工作
- **上下文连贯**：启用上下文继承，保持分析一致性
- **质量保证**：确保每个组件输出质量

### 执行要点
1. **识别场景**：确定当前诉讼阶段和需求
2. **选择模板**：优先使用快速启动模板
3. **补充输入**：提供必要的输入材料
4. **启用继承**：如有必要，开启上下文继承
5. **监控质量**：确保输出符合要求

### 文档更新要求
完成任一组件或模板后：
- 更新 `status/CHANGELOG.md` 记录变更
- 在 `status/JOURNAL.md` 记录执行日志
- 重要决策更新 `docs/DECISIONS.md`

## 时间要求

- **单个模板执行**：5-30 分钟（根据模板类型）
- **增量更新**：比完整流程快 50-70%
- **并行执行**：利用并行性提高效率

## 案件上下文维护

### 上下文管理机制

为每个案件维护独立的上下文信息，确保所有Agent能够了解案件当前状态、工作进度和历史记录。

#### 上下文信息来源

**主要来源**:
- `[案件编号].yaml` - 案件管理看板数据，包含完整案件信息
- `[案件编号].md` - 工作记录，包含详细的工作历史和进展
- 各工作流输出目录 - 对应的分析结果和文档

**上下文内容**:
```yaml
案件基本信息:
  案件编号: "[2025]京0105民初1234号"
  案件性质: "民事"
  当前状态: "庭审准备"
  案件阶段: "一审"

工作进度:
  已完成工作:
    - 案件分析 (2025-03-18)
    - 证据整理 (2025-04-05)
    - 答辩状起草 (2025-05-10)
  正在进行:
    - 举证准备 (完成度: 70%)
  待开始工作:
    - 质证意见书
    - 代理词

关键信息:
  争议焦点: [焦点列表]
  法律研究: [研究结果]
  策略方案: [策略要点]
  风险预警: [风险列表]
```

#### Agent使用指南

**工作前**:
1. **读取案件上下文** - 首先读取 `[案件编号].yaml` 和 `[案件编号].md`
2. **了解当前状态** - 查看案件阶段、已完成工作、待办事项
3. **检查相关输出** - 读取相关工作流的最新输出

**工作中**:
1. **保持上下文连贯** - 基于现有上下文进行分析和决策
2. **复用历史结果** - 引用之前的分析结果，避免重复工作
3. **增量更新** - 在现有基础上增量更新，而非重新开始

**工作后**:
1. **更新上下文** - 将新的分析结果和工作记录更新到对应文件
2. **同步信息** - 确保yaml和md文件信息保持同步
3. **标记完成** - 更新工作进度和状态

#### 上下文继承规则

**自动继承**:
- 案件基本信息 - 贯穿整个案件生命周期
- 当事人信息 - 保持不变，除非有变更
- 争议焦点 - 在分析过程中不断细化
- 法律研究结果 - 持续积累和更新
- 策略方案 - 根据进展调整和优化

**增量更新**:
- 工作记录 - 每日新增
- 期限管理 - 实时更新
- 风险预警 - 动态调整
- 文档状态 - 完成时更新

**版本管理**:
- 重要更新标注版本号
- 保留关键节点的快照
- 支持回溯和对比

## 文档管理结构

### 输出目录规范

所有工作流的输出都应按照标准化目录结构组织：

```
output/cases/
├── [案件编号]/              # 按案件编号分类存放
│   ├── 01_案件分析/             # DocAnalyzer + Strategist输出
│   ├── 02_法律研究/             # IssueIdentifier + Researcher输出
│   ├── 03_证据材料/             # EvidenceAnalyzer输出
│   ├── 04_法律文书/             # Writer输出
│   │   ├── 起诉状/
│   │   ├── 答辩状/
│   │   ├── 代理词/
│   │   ├── 质证意见书/
│   │   ├── 申请书/
│   │   ├── 上诉状/
│   │   ├── 律师函/
│   │   ├── 调解协议/
│   │   ├── 保全申请/
│   │   ├── 执行申请/
│   │   ├── 法律意见书/
│   │   └── 其他文书/
│   ├── 05_综合报告/             # Summarizer + Reporter输出
│   └── 06_日程管理/             # Scheduler输出
│       ├── 日程安排/             # 案件时间线管理
│       ├── 工时统计/             # 工作时间记录和报表
│       ├── 期限提醒/             # 法定期限预警
│       ├── [案件编号].yaml       # 案件管理看板数据
│       ├── [案件编号].md         # 案件工作记录
│       └── 工作记录模板.md       # 工作记录格式模板
└── 模板库/                  # 通用模板和格式
```

### 文档命名规范

- **案件编号**: `[YYYY]省[城市]民初/行初/刑初[序号]号`
- **文档命名**: `[日期]_[文档类型]_[版本]`
- **版本管理**: 初稿 → 修订稿 → 最终稿 或 v1.0 → v2.0

### PDF扫描处理指引

当传入PDF文档时，系统应自动完成以下处理：

#### 1. PDF扫描与OCR识别
- **文字层提取**: 检查PDF是否已有文字层
- **OCR识别**: 如果是扫描件，使用OCR技术提取文字
- **文字精度**: 确保文字识别准确率（建议95%+）
- **多语言支持**: 支持中文、英文混合识别

#### 2. 双格式输出
**输出1: 带有文字层的PDF**
- **保持原貌**: 保留原PDF的页面布局和图像
- **添加文字层**: 在图像上叠加可选择的文字层
- **可搜索**: 支持PDF内文字搜索功能
- **可编辑**: 文字层可复制、选择、编辑

**输出2: Markdown文件**
- **结构化内容**: 将识别的文字转换为Markdown格式
- **保持逻辑**: 维持原文的段落、标题、列表结构
- **元数据提取**: 提取文档标题、页码、日期等信息
- **清洁文本**: 去除OCR识别的噪声和错误

#### 3. 处理流程
```
输入PDF → OCR识别 → 文字层生成 → Markdown转换 → 双格式输出
```

#### 4. 质量优化
- **预处理**: 图像增强、噪声去除、倾斜校正
- **后处理**: 拼写检查、格式校正、段落整理
- **人工校对**: 关键信息标记不确定区域
- **质量报告**: 生成识别质量评估报告

#### 5. 支持场景
- **扫描合同**: 提取合同条款，生成可编辑版本
- **法院传票**: 识别传票信息，自动提取日期、案号
- **证据材料**: 提取证据内容，支持后续分析
- **判决书**: 识别判决内容，生成结构化文档

#### 6. 示例操作

**输入**: `证据材料.pdf` (扫描件)

**处理过程**:
1. OCR识别提取文字
2. 生成带文字层的 `证据材料_文字层.pdf`
3. 转换为Markdown `证据材料.md`
4. 质量检查和格式优化

**输出**:
- `证据材料_文字层.pdf` - 可搜索的PDF
- `证据材料.md` - Markdown格式
- `证据材料_OCR报告.txt` - 识别质量报告

### 新材料自动分类指引

当在`input/`目录放置新材料时，DocAnalyzer应自动完成以下操作：

#### 1. 材料归属识别
- **案号提取**: 从文档中提取案件编号 `[YYYY]省[城市]民初/行初/刑初[序号]号`
- **案件匹配**: 检查是否存在对应的案件文件夹
- **新案件创建**: 如不存在，则创建新的案件文件夹结构

#### 2. 材料类型分析
根据材料内容和特征，自动分类：

| 材料类型 | 识别特征 | 放置位置 |
|----------|----------|----------|
| **起诉状** | "原告"、"被告"、"诉讼请求" | `01_案件分析/` |
| **证据材料** | "证据"、"附件"、"证明目的" | `03_证据材料/` |
| **庭审笔录** | "庭审"、"审判员"、"当事人" | `01_案件分析/` |
| **判决书** | "判决"、"裁定"、"法院认为" | `01_案件分析/` |
| **法律文书** | "答辩状"、"代理词"等 | `04_法律文书/[类型]/` |
| **工作记录** | "工时"、"工作内容"、"期限" | `06_日程管理/` |

#### 3. 自动放置流程
```
input/新材料 → DocAnalyzer分析 → 案件归属识别 → 材料类型判断 → 自动放置到对应目录
```

#### 4. 批量处理支持
- **ZIP压缩包**: 自动解压并逐个分析
- **多文件处理**: 同时处理多个文档
- **OCR识别**: 支持扫描件文字提取

#### 5. 命名规范应用
- **自动重命名**: 按格式 `[日期]_[文档类型]_[版本]` 重命名
- **版本管理**: 自动添加版本号 (初稿/修订稿/最终稿)
- **冲突处理**: 检测重名文件，避免覆盖

#### 6. 上下文更新
- **yaml文件更新**: 更新案件管理看板数据
- **md文件更新**: 添加工作记录
- **进度标记**: 标记新完成的工作

### 示例操作流程

**输入**:
```
input/
├── [2025]京0105民初1234号_答辩状_初稿.docx
└── 新证据_合同书.pdf
```

**DocAnalyzer自动处理**:
1. 识别`[2025]京0105民初1234号`案件
2. 分析两个文档类型
3. 自动放置:
   - 答辩状 → `04_法律文书/答辩状/`
   - 合同书 → `03_证据材料/`
4. 更新案件上下文
5. 生成处理报告

### Agent输出指引

每个Agent都应将输出保存到对应的专门文件夹中：

- **DocAnalyzer** → `01_案件分析/` - 案件分析报告、当事人信息、诉讼请求
- **Strategist** → `01_案件分析/` - 策略方案、SWOT分析、风险评估
- **IssueIdentifier** → `02_法律研究/` - 争议焦点列表、焦点分析
- **Researcher** → `02_法律研究/` - 法律研究报告、法条检索、判例研究
- **EvidenceAnalyzer** → `03_证据材料/` - 证据目录、质证意见、补充证据建议
- **Writer** → `04_法律文书/[具体文书类型]/` - 12种法律文书分类存储
- **Summarizer** → `05_综合报告/` - 案件摘要、风险摘要
- **Reporter** → `05_综合报告/` - 综合分析报告、阶段进展报告
- **Scheduler** → `06_日程管理/` - 期限提醒、工时统计、日程安排 (支持YAML+MD双版本)

## 重要指令

- Do what has been asked; nothing more, nothing less.
- NEVER create files unless they're absolutely necessary.
- ALWAYS prefer editing an existing file to creating a new one.
- NEVER proactively create documentation files (*.md) unless requested.

---

> 更多详细配置请参阅：
> - `.claude/agents/` 目录下的各组件配置文件
> - `.claude/memory/` 目录下的知识库和模板（法律模板、规范标准、AI技能等）
> - `output/cases/` 目录下的文档管理结构

---

## 附录 A：agents详细规范

### 1. DocAnalyzer（文档分析器）
**配置文件**: `agents/DocAnalyzer.md`
**核心功能**: 分析各类法律文档（起诉状、证据、庭审笔录等）
**可独立使用**: ✓ 是
**输入**: 文档文件
**输出**: 案件要素、文档摘要

### 2. EvidenceAnalyzer（证据分析器）
**配置文件**: `agents/EvidenceAnalyzer.md`
**核心功能**: 证据分析、质证意见、补充证据清单
**可独立使用**: ✓ 是
**输入**: 证据材料
**输出**: 证据分析报告、质证意见

### 3. IssueIdentifier（争议识别器）
**配置文件**: `agents/IssueIdentifier.md`
**核心功能**: 识别和归类争议焦点
**可独立使用**: ✓ 是
**输入**: 案件要素
**输出**: 争议焦点列表

### 4. Researcher（法律研究器）
**配置文件**: `agents/Researcher.md`
**核心功能**: 法条解读、判例检索、法律适用路径
**可独立使用**: ✓ 是
**输入**: 争议焦点
**输出**: 法律研究报告

### 5. Strategist（策略制定者）
**配置文件**: `agents/Strategist.md`
**核心功能**: SWOT分析、策略制定、风险评估
**可独立使用**: ✓ 是
**输入**: 案件分析、法律研究
**输出**: 策略方案、风险评估

### 6. Writer（文书起草者）
**配置文件**: `agents/Writer.md`
**核心功能**: 起草答辩状、代理词、质证意见等
**可独立使用**: ✓ 是
**输入**: 所有分析结果
**输出**: 法律文书
**模板库**: `.claude/templates/legal_briefs/`

### 7. Summarizer（摘要生成者）
**配置文件**: `agents/Summarizer.md`
**核心功能**: 生成各类摘要和简报
**可独立使用**: ✓ 是
**输入**: 任意内容
**输出**: 摘要报告

### 8. Reporter（报告者）
**配置文件**: `agents/Reporter.md`
**核心功能**: 整合所有内容，生成最终报告
**可独立使用**: ✓ 是
**输入**: 所有输出
**输出**: 综合性报告

### 9. Scheduler（日程规划者）
**配置文件**: `agents/Scheduler.md`
**核心功能**: 法律期限管理和工时统计
**可独立使用**: ✓ 是
**输入**: 法院文件、工作记录
**输出**: 期限提醒、时间线、工时报表

### 10. 🆕 Reviewer（智能审查器）
**配置文件**: `agents/Reviewer.md`
**核心功能**: 跨Agent质量审查、全局一致性检查、风险识别与预警
**可独立使用**: ✓ 是（作为Subagent）
**触发方式**: Subagent模式被调用（自动/手动/条件触发）
**输入**: 所有Agent的输出
**输出**: 质量评估报告、问题清单、修改建议、风险评级
**审查范围**: 格式规范、法律适用、逻辑严密性、数据一致性、风险评估
**质量评级**: A/B/C/D四级评分体系
**调用场景**: 高风险案件、重要文书、质量异常、用户要求
**未来规划**: 文件生成后hooks自动审查机制（见ROADMAP.md）

---

## 附录 A.1：Claude Code 技能（Skills）规范

SuitAgent 系统中使用的 Claude Code 官方技能，通过 `.claude/skills/` 目录提供扩展功能。

### 可用技能

#### 1. new-case（案件创建技能）
**技能文件**: `.claude/skills/new-case.md`
**核心功能**: 在 SuitAgent 系统中创建标准化的案件工作目录结构
**使用方法**: 在对话中直接说明："请为案件 [2025]京0105民初1234号 创建工作区"
**可独立使用**: ✓ 是
**功能说明**:
- 自动创建包含6个标准子目录的案件工作区
- 复制模板文件并自动重命名
- 创建 `[案件编号].yaml` 和 `[案件编号].md` 管理文件
- 验证案件编号格式并检查冲突
- 替换文件中的占位符为实际案件编号

**模板来源**: `.claude/memory/case-template/`

#### 2. docx（Word文档处理）
**技能文件**: `.claude/skills/docx.md`
**核心功能**: Word 文档的创建、编辑和分析
**可独立使用**: ✓ 是
**主要功能**:
- 创建新 Word 文档
- 编辑现有文档
- 跟踪修改和批注
- 文档格式转换

#### 3. pdf（PDF文档处理）
**技能文件**: `.claude/skills/pdf.md`
**核心功能**: PDF 文档的创建、编辑和分析
**可独立使用**: ✓ 是
**主要功能**:
- PDF 文档解析
- 文本和表格提取
- PDF 合并和分割
- 表单处理

#### 4. xlsx（Excel文档处理）
**技能文件**: `.claude/skills/xlsx.md`
**核心功能**: Excel 文档的创建、编辑和分析
**可独立使用**: ✓ 是
**主要功能**:
- 数据分析
- 公式计算
- 图表生成
- 数据可视化

### 技能使用方式

**方式一：直接对话调用**
在对话中自然描述需求，系统自动匹配相应技能：
```
"请为案件 [2025]京0105民初1234号 创建工作区"
"需要处理这个 Word 文档"
"要分析这个 PDF 文件"
```

**方式二：JSON 配置调用**
```json
{
  "skill": "new-case",
  "parameters": {
    "case_id": "[2025]京0105民初1234号"
  }
}
```

### 技能开发规范

所有新技能应：
1. 遵循 Claude Code 技能文件格式（YAML front matter + 详细文档）
2. 存放在 `.claude/skills/` 目录
3. 包含清晰的功能说明和使用示例
4. 提供完整的错误处理和验证机制
5. 支持独立使用和集成使用

---

## 附录 B：诉讼阶段快速启动模板

### 1. 初始案件分析 (initial_case_analysis)
**适用场景**: 接收新案件时的全面分析
**工作流组合**:
```
DocAnalyzer → IssueIdentifier → Researcher → Strategist → Writer → Summarizer → Reporter
```
**预计时间**: 20-25 分钟

### 2. 新证据质证 (evidence_review)
**适用场景**: 收到新证据材料，需要写质证意见
**工作流组合**:
```
DocAnalyzer(新证据) + EvidenceAnalyzer → Researcher(针对争议) → Writer(质证意见) → Summarizer
```
**预计时间**: 10-15 分钟
**特点**: 复用之前的争议焦点分析

### 3. 答辩意见起草 (defense_drafting)
**适用场景**: 收到起诉状，需要起草答辩意见
**工作流组合**:
```
DocAnalyzer(起诉状) → IssueIdentifier → Researcher → Writer(答辩状) → Summarizer
```
**预计时间**: 15-20 分钟

### 4. 补充证据 (evidence_supplement)
**适用场景**: 发现证据不足，需要补充证据
**工作流组合**:
```
EvidenceAnalyzer(现有证据) → Researcher → Strategist → EvidenceAnalyzer(补充清单)
```
**预计时间**: 8-12 分钟

### 5. 庭审笔录分析 (hearing_record_analysis)
**适用场景**: 庭审后分析，调整策略
**工作流组合**:
```
DocAnalyzer(庭审笔录) → EvidenceAnalyzer(对比前后) → Strategist(调整策略) → Summarizer
```
**预计时间**: 12-18 分钟

### 6. 代理词起草 (proxy_drafting)
**适用场景**: 庭前或庭后起草代理词
**工作流组合**:
```
DocAnalyzer(全案材料) → EvidenceAnalyzer → IssueIdentifier → Researcher → Strategist → Writer(代理词) → Reporter
```
**预计时间**: 20-30 分钟

### 7. 案件进展总结 (case_progress_summary)
**适用场景**: 阶段性总结汇报
**工作流组合**:
```
DocAnalyzer(庭审笔录) + EvidenceAnalyzer(全证据) + Summarizer → Strategist → Reporter(阶段报告)
```
**预计时间**: 10-15 分钟

### 8. 风险评估报告 (risk_assessment)
**适用场景**: 需要专门的风险评估
**工作流组合**:
```
Strategist → Summarizer(风险摘要) → Reporter
```
**预计时间**: 5-10 分钟

---

## 附录 C：法律文书模板库

### 可用模板

| 模板名称 | 文件名 | 适用场景 |
|----------|--------|----------|
| 起诉状 | `complaint.md` | 提起诉讼 |
| 答辩状 | `defense.md` | 收到起诉状后 |
| 代理词 | `proxy_opinion.md` | 庭审前/后 |
| 质证意见书 | `evidence_opinion.md` | 对新证据质证 |
| 申请书 | `application.md` | 申请特定事项 |
| 上诉状 | `appeal.md` | 不服一审判决 |

### 使用方法
Writer 组件会自动根据文书类型选择对应模板，并根据输入内容填充。

详细模板规范请参阅：`.claude/templates/legal_briefs/README.md`

---

## 附录 D：技术细节

### 上下文继承机制

#### 继承字段
- case_id：案件ID
- case_basics：案件基本信息
- legal_issues：争议焦点
- legal_research：法律研究结果
- strategy_plan：策略方案
- evidence_analysis：证据分析
- generated_briefs：已生成文书

#### 使用方式
在模板配置中设置 `context_inherit.enabled: true`，系统将自动继承并更新上下文。

### 并行执行支持

#### 可并行组合
- **DocAnalyzer** + **EvidenceAnalyzer**（分析新证据时）
- **IssueIdentifier** + **EvidenceAnalyzer**（庭审后分析时）
- **Researcher** 内部步骤（法条+判例）
- **Strategist** 内部步骤（SWOT+风险评估）

#### 串行依赖
- **Researcher** 依赖 **IssueIdentifier**
- **Strategist** 依赖 **Researcher**
- **Writer** 依赖 **Strategist** + **Researcher**

### 自定义工作流示例

```json
{
  "name": "CustomWorkflow",
  "components": [
    "DocAnalyzer",
    {"name": "IssueIdentifier", "parallel": true},
    "Researcher"
  ],
  "inputs": {},
  "outputs": {}
}
```

---

## 附录 E：完整目录结构

```
.claude/
├── agents/                    # 10个agents
│   ├── DocAnalyzer.md         # 文档分析器
│   ├── EvidenceAnalyzer.md    # 证据分析器
│   ├── IssueIdentifier.md     # 争议识别器
│   ├── Researcher.md          # 法律研究者
│   ├── Strategist.md          # 策略制定者
│   ├── Writer.md              # 文书起草者
│   ├── Summarizer.md          # 摘要生成者
│   ├── Reporter.md            # 报告整合者
│   ├── Scheduler.md           # 日程规划者
│   └── Reviewer.md            # 智能审查器（Subagent模式）
├── memory/                    # 知识库和模板
│   ├── standards/            # 规范标准文档（AI使用）
│   │   ├── QUALITY_REVIEW_STANDARDS.md  # 质量审查标准
│   │   ├── AGENT_OUTPUT_MANAGEMENT.md   # Agent输出管理规范
│   │   ├── DEVELOPMENT.md               # AI代理协作规范
│   │   └── INTELLIGENT_CASE_RECOGNITION.md  # 案件智能识别设计
│   ├── templates/            # 快速启动模板
│   │   ├── initial_case_analysis.json
│   │   ├── evidence_review.json
│   │   ├── defense_drafting.json
│   │   ├── evidence_supplement.json
│   │   ├── hearing_record_analysis.json
│   │   ├── proxy_drafting.json
│   │   ├── case_progress_summary.json
│   │   ├── risk_assessment.json
│   │   └── legal_briefs/         # 法律文书模板库
│   │       ├── README.md
│   │       ├── defense.md        # 答辩状模板
│   │       ├── proxy_opinion.md  # 代理词模板
│   │       └── ...
│   ├── case-template/        # 案件模板目录（用于new-case技能）
│   │   ├── [案件编号].yaml    # 案件管理看板模板
│   │   ├── [案件编号].md      # 案件工作记录模板
│   │   ├── 01_案件分析/         # 案件分析输出目录
│   │   ├── 02_法律研究/         # 法律研究输出目录
│   │   ├── 03_证据材料/         # 证据分析输出目录
│   │   ├── 04_法律文书/         # 12种法律文书输出目录
│   │   ├── 05_综合报告/         # 报告整合输出目录
│   │   └── 06_日程管理/         # 日程规划输出目录
│   ├── legal_templates.md    # 法律模板库
│   ├── legal_deadlines.md    # 法律期限速查
│   └── claude_code_skills.md # Claude Code 技能参考
├── docs/                      # 系统文档（项目进展）
│   ├── DECISIONS.md           # 架构决策记录
│   ├── ROADMAP.md             # 项目路线图
│   ├── ARCHITECTURE.md        # 系统架构文档
│   └── research/              # 研究文档
├── output/                    # 案件工作输出目录
│   └── cases/                 # 按案件编号分类存放
│       └── [案件编号]/        # 案件工作区
│           ├── [案件编号].yaml    # 案件管理看板数据
│           ├── [案件编号].md      # 案件工作记录
│           └── ...             # 其他工作流输出
└── CLAUDE.md                 # 本文件
```

---

*本文档整合了协作指南和所有技术细节，为 SuitAgent 系统提供完整的使用说明。*

